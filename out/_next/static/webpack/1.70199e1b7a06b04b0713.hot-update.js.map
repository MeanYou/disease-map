{"version":3,"file":"static/webpack/1.70199e1b7a06b04b0713.hot-update.js","sources":["webpack:///./components/MyMap.tsx"],"sourcesContent":["import L from 'leaflet';\r\nimport { useRef, useEffect } from \"react\";\r\nimport axios from 'axios';\r\n\r\nconst MyMap = () => {\r\n    const mapRef = useRef<L.Map>();\r\n    const mapBoxRef = useRef<HTMLDivElement>(null);\r\n    // 初始化加载地图\r\n    useEffect(() => {\r\n        // dom加载完成后新建地图\r\n        mapRef.current = new L.Map(mapBoxRef.current as HTMLDivElement, {\r\n            center: [39.90791, 116.397006],\r\n            zoom: 11\r\n        });\r\n        // 高德地图切片地址\r\n        const url = \"http://webrd0{s}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&lang=zh_cn&size=1&scale=1&style=8\";\r\n        new L.TileLayer(url, {\r\n            subdomains: \"1234\"\r\n        }).addTo(mapRef.current);\r\n        // 绑定地图事件\r\n        mapRef.current.addEventListener('dragend', (e) => {\r\n            console.log(e.target.getCenter());\r\n            console.log(e.target.getZoom());\r\n        });\r\n\r\n        return () => {\r\n            mapRef.current = undefined;\r\n        };\r\n    }, []);\r\n\r\n    // 获取用户位置，使用腾讯接口获取疫情信息\r\n    useEffect(() => {\r\n        navigator.geolocation.getCurrentPosition((position) => {\r\n            mapRef.current?.flyTo([position.coords.latitude, position.coords.longitude], 17);\r\n            // 首先根据经纬度获取所在城市\r\n            const url = `https://restapi.amap.com/v3/geocode/regeo?location=${position.coords.longitude},${position.coords.latitude}&key=ee420794c4113817c43da88d7dc18130`;\r\n            axios.get(url).then((res) => {\r\n                console.log(res);\r\n            });\r\n        }, () => {\r\n            alert('获取位置失败了呀');\r\n        }, {});\r\n    }, []);\r\n\r\n    return (\r\n        <>\r\n            <div id=\"map\" ref={mapBoxRef}></div>\r\n            <style jsx>{`\r\n                #map {\r\n                    width: 100%;\r\n                    height: 100%;\r\n                    position: absolute;\r\n                    left: 0;\r\n                    top: 0;\r\n                }\r\n            `}</style>\r\n        </>\r\n\r\n    );\r\n}\r\n\r\nexport default MyMap;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AAIA;AACA;AACA;AADA;AACA;AAGA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAcA;AACA;AACA;;;;A","sourceRoot":""}